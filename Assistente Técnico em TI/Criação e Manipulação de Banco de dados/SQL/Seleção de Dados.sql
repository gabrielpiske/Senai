CREATE DATABASE ASSISTENTETECNICO;

USE ASSISTENTETECNICO;

CREATE TABLE GRADE_SALARIAL (
ID_GRADE INT NOT NULL,
MENOR_SALARIO DECIMAL(10,2) NOT NULL,
MAIOR_SALARIO DECIMAL(10,2) NOT NULL,
PRIMARY KEY(ID_GRADE));

CREATE TABLE DEPARTAMENTO (
ID_DEPARTAMENTO INT NOT NULL,
NM_DEPARTAMENTO VARCHAR(30) NOT  NULL,
LOCALIZACAO VARCHAR(20) NOT NULL,
PRIMARY KEY(ID_DEPARTAMENTO));

CREATE TABLE EMPREGADO (
ID_EMPREGADO INT NOT NULL,
NM_EMPREGADO VARCHAR(45) NOT NULL,
FUNCAO VARCHAR(45) NOT NULL,
LIDER INTEGER NULL,
DATA_CONTRATACAO DATE NOT NULL,
SALARIO DECIMAL(10,2) NOT NULL,
COMISSAO DECIMAL(10,2) NULL,
ID_DEPARTAMENTO INTEGER NOT NULL,
PRIMARY KEY(ID_EMPREGADO), 
FOREIGN KEY(ID_DEPARTAMENTO) REFERENCES DEPARTAMENTO(ID_DEPARTAMENTO),
FOREIGN KEY(LIDER) REFERENCES EMPREGADO(ID_EMPREGADO));

INSERT INTO DEPARTAMENTO VALUES (10,'CONTÁBIL','NEW YORK');
INSERT INTO DEPARTAMENTO VALUES (20,'PESQUISA E DESENVOLVIMENTO','DALLAS');
INSERT INTO DEPARTAMENTO VALUES (30,'VENDAS','CHICAGO');
INSERT INTO DEPARTAMENTO VALUES (40,'OPERAÇÕES','BOSTON');

INSERT INTO EMPREGADO VALUES (7839,'KING','PRESIDENTE',NULL,'1981-11-17',5000,NULL,10);
INSERT INTO EMPREGADO VALUES (7698,'BLAKE','GERENTE',7839,'1981-05-01',2850,NULL,30);
INSERT INTO EMPREGADO VALUES (7782,'CLARK','GERENTE',7839,'1981-06-09',2450,NULL,10);
INSERT INTO EMPREGADO VALUES (7566,'JONES','GERENTE',7839,'1981-07-02',2975,NULL,20);
INSERT INTO EMPREGADO VALUES (7654,'MARTIN','VENDEDOR',7698,'1981-09-28',1250,1400,30);
INSERT INTO EMPREGADO VALUES (7499,'ALLEN','VENDEDOR',7698,'1981-02-20',1600,300,30);
INSERT INTO EMPREGADO VALUES (7844,'TURNER','VENDEDOR',7698,'1981-09-08',1500,0,30);
INSERT INTO EMPREGADO VALUES (7900,'JAMES','ESCRITURÁRIO',7698,'1981-12-03',950,NULL,30);
INSERT INTO EMPREGADO VALUES (7521,'WARD','VENDEDOR',7698,'1981-02-22',1250,500,30);
INSERT INTO EMPREGADO VALUES (7902,'FORD','ANALISTA',7566,'1981-12-03',3000,NULL,20);
INSERT INTO EMPREGADO VALUES (7369,'SMITH','ESCRITURÁRIO',7902,'1980-12-17',800,NULL,20);
INSERT INTO EMPREGADO VALUES (7788,'SCOTT','ANALISTA',7566,'1982-12-09',3000,NULL,20);
INSERT INTO EMPREGADO VALUES (7876,'ADAMS','ESCRITURÁRIO',7788,'1983-01-12',1100,NULL,20);
INSERT INTO EMPREGADO VALUES (7934,'MILLER','ESCRITURÁRIO',7782,'1982-01-23',1300,NULL,10);

INSERT INTO GRADE_SALARIAL VALUES (1,700,1200);
INSERT INTO GRADE_SALARIAL VALUES (2,1201,1400);
INSERT INTO GRADE_SALARIAL VALUES (3,1401,2000);
INSERT INTO GRADE_SALARIAL VALUES (4,2001,3000);
INSERT INTO GRADE_SALARIAL VALUES (5,3001,9999);

DESC DEPARTAMENTO;
DESC EMPREGADO;
DESC GRADE_SALARIAL;

SELECT * FROM grade_salarial; 
SELECT * FROM departamento;
SELECT * FROM empregado;
SELECT ID_EMPREGADO, NM_EMPREGADO FROM EMPREGADO;
SELECT NM_EMPREGADO NOME, FUNCAO FUNÇÃO, SALARIO "SALÁRIO FIXO" FROM EMPREGADO;

SELECT NM_EMPREGADO, FUNCAO, SALARIO
	FROM EMPREGADO
	WHERE ID_DEPARTAMNETO = 10 AND SALARIO > 1000;
    
SELECT NM_EMPREGADO, FUNCAO, SALARIO
	FROM EMPREGADO
	WHERE NM_EMPREGADO LIKE 'S%'; ## busca valores alfanuméricos incompletos a partir de um ou mais caracteres.
    
SELECT NM_EMPREGADO, FUNCAO, SALARIO
	FROM EMPREGADO
	WHERE COMISSAO IS NULL; ## é utilizado quando é necessário avaliar se uma coluna apresentar ou não valor nulo.

SELECT NM_EMPREGADO, FUNCAO, SALARIO, ID_DEPARTAMENTO
	FROM EMPREGADO
	WHERE ID_DEPARTAMENTO IN (10,30) ## é utilizado para testar a coluna em uma lista de valores.
    ORDER BY NM_EMPREGADO DESC;

SELECT NM_EMPREGADO, FUNCAO, SALARIO, ID_DEPARTAMENTO
	FROM EMPREGADO
	WHERE SALARIO between 800 AND 1200; ## testar um intervalo de valores.
    
SELECT NM_EMPREGADO, FUNCAO, SALARIO, ID_DEPARTAMENTO
	FROM EMPREGADO
	WHERE SALARIO NOT between 800 AND 1200; ## NÃO testar ESTE  intervalo de valores.
    
SELECT NM_EMPREGADO, FUNCAO, SALARIO, ID_DEPARTAMENTO
	FROM EMPREGADO
	ORDER BY FUNCAO DESC, NM_EMPREGADO ASC;
    
SELECT NM_EMPREGADO, FUNCAO, SALARIO, ID_DEPARTAMENTO
	FROM EMPREGADO
	ORDER BY 3 DESC, 1;
    
SELECT UPPER(NM_EMPREGADO), LOWER(FUNCAO), SALARIO, ID_DEPARTAMENTO ## Deixar letras grandes e pequenas
	FROM EMPREGADO
    ORDER BY 3 DESC, 1 ASC;